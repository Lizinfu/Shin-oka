#!/bin/bash

# --- 配置区 ---
BRANCH="main" 

# --- 逻辑区 ---

# 1. 检查是否有参数（提交信息）
if [ -z "$1" ]; then
    echo "❌ 错误: 请输入提交信息！"
    echo "用法: sh update.sh \"这里写你的提交内容\""
    exit 1
fi

COMMIT_MSG=$1

echo "---------------------------------------"
echo "🚀 开始同步到 GitHub..."
echo "---------------------------------------"

# 2. 添加所有更改到暂存区
echo "📦 正在添加文件..."
git add .

# 3. 提交更改
echo "📝 正在本地提交: $COMMIT_MSG"
git commit -m "$COMMIT_MSG"

# 4. 推送到远程仓库
echo "⬆️  正在推送到远程分支 $BRANCH..."
# 尝试推送，如果失败则报错退出
if git push origin $BRANCH; then
    echo "---------------------------------------"
    echo "✅ 成功推送！GitHub Action 将开始构建您的网站。"
    echo "---------------------------------------"
else
    echo "---------------------------------------"
    echo "❌ 推送失败，请检查网络或冲突。"
    echo "---------------------------------------"
    exit 1
fi